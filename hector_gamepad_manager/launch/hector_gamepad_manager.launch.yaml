launch:
- arg:
    name: "config_switches_filename"
    # Meta Config File that determines which buttons activate which config
    default: "config_switches"
- arg:
    name: "ns"
    default: ""
- arg:
    name: "stamped"
    default: "true"
- arg:
    name: "robot_name"
    default: "athena"

- let:
    name: "cmd_vel_topic"
    value: "cmd_vel"
    if: $(var stamped)
- let:
    name: "cmd_vel_topic"
    value: "cmd_vel_stamped"
    unless: $(var stamped)

- push-ros-namespace:
    namespace: "$(var ns)"

- node:
    pkg: "hector_gamepad_manager"
    exec: "hector_gamepad_manager_node"
    name: "hector_gamepad_manager_node"
    output: "screen"
    param:
      - name: "config_switches_filename"
        value: "$(var config_switches_filename)"
      - name: "robot_name"
        value: "$(var robot_name)"
    remap:
        - from: "cmd_vel"
          to: $(var cmd_vel_topic)


- node:
    pkg: "topic_tools"
    exec: "relay_field"
    name: "convert_cmd_vel"
    args: "cmd_vel_stamped cmd_vel geometry_msgs/msg/Twist \"{linear: m.twist.linear, angular: m.twist.angular}\" --wait-for-start"
    output: "screen"
    unless: $(var stamped)
